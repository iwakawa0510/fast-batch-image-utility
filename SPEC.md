# Fast Batch Image Utility - Technical Specification

## 1. 概要 / Overview

本ツールは、**2Dアニメーション作画・CG制作パイプラインにおける前工程・後工程専用の高速バッチ画像変換ユーティリティ**である。

特定の商用製品・アプリケーション・ファイル形式に直接依存・統合するものではなく、
**一般的な2Dアニメーション作画ソフトウェアの前後で使用される外部ツール**として設計する。

目的は以下に限定する：

- 単純だが大量に発生する画像変換作業の自動化
- 極力少ないUI操作で即座に実行できること
- 機能削減と引き換えに処理速度を最大化すること

本ツールは、**制作者本人および少人数の実務ユーザーによる継続利用**を前提とし、
汎用的な画像編集ソフトやエンドユーザー向け製品を目指さない。

---

## 2. 対応プラットフォーム

- **Windows 10 / 11 (x64)** : 必須
- Linux : 任意（優先度低）

---

## 3. 実装言語・ビルド

- 実装言語：**C++20**
- ビルドシステム：**CMake**
- 出力形式：ネイティブバイナリ（exe / ELF）
- スクリプト言語（Python 等）による実装は禁止

---

## 4. 配布形態

- ZIP配布
- **すべての依存関係は1フォルダに完結**
- レジストリ、ユーザーフォルダ、システムフォルダへの書き込み禁止
- インストーラ不要

---

## 5. 対応画像フォーマット

### 入力
- PNG
- TIFF
- TGA
- JPEG
- BMP（任意）

### 出力
- PNG（必須）

---

## 6. 必須変換ファンクション（MVP）

### 6.1 Luminance → Alpha 変換（必須）

- 入力画像の輝度をアルファ値に変換
- RGBは黒（0,0,0）固定
- 輝度計算式：

L = 0.299 * R + 0.587 * G + 0.114 * B  
Alpha = L

用途：
- 線画素材・マスク素材生成
- 2Dアニメーション作画工程用の前処理素材作成

---

### 6.2 任意フォーマット → PNG 変換（必須）

- 入力画像をPNGへ一括変換
- アルファ保持
- 色変換なし

---

## 7. 非目標（明確に禁止）

- フィルタチェーン
- プラグイン機構
- スクリプト拡張
- レイヤー編集
- 画像描画・ペイント機能
- 特定アプリケーションとの直接連携・自動制御

---

## 8. 処理性能要件

- **処理速度最優先**
- ファイル単位で完全独立処理
- CPUマルチスレッド必須
- GPUアクセラレーションは使用しない（将来拡張余地のみ残す）

### スレッド
- デフォルト：自動（CPU論理コア数）
- CLIから任意指定できる場合は尚可（必須ではない）

---

## 9. SIMD

- SSE2 / AVX2 等のSIMD最適化は **可能なら実装**
- SIMD未対応環境でも動作するフォールバック必須
- SIMD実装はMVP必須条件ではない

---

## 10. GUI要件

### 10.1 GUIの基本方針

- マイクロUIに固執しない
- 必要十分で破綻しないシンプルUI
- IME入力不要
- マウス操作のみで完結
- 起動後すぐに変換可能であること

### 10.2 GUI必須要素

- 入力フォルダ選択
- 出力フォルダ選択
- 変換ファンクション選択
- プレビュー表示領域
- 実行ボタン
- 進捗表示
- 言語切替（日本語 / 英語 / フランス語）

※ 機能仕様の正は README を優先する。

---

## 11. プレビュー要件

- 単一ファイルの **変換前 / 変換後 比較表示**
- 表示専用（編集不可）
- 以下の表示モードを含む：
  - RGBA通常表示
  - Alphaのみ表示（グレースケール）
  - チェッカーパターン背景

※ 実装済み仕様の詳細は README 側に記載される。

---

## 12. CLI要件

- CLIは **開発者・上級ユーザー向け**
- 束縛条件は弱く、十分条件のみを定義
- GUIとは独立して実行可能
- 出力・ヘルプは英語のみ

例：

tool.exe --input in_dir --output out_dir --function luma2alpha --threads auto

---

## 13. 国際化（i18n）

### GUI
- デフォルト：日本語
- 英語・フランス語切替対応
- UTF-8固定
- 固定文言のみ（ユーザー入力テキストなし）

### CLI
- 英語のみ

---

## 14. GUIフレームワーク

- 指定なし
- 選定理由を README に明記すること
- Qt / Dear ImGui 等を含め、要件を満たせば可

---

## 15. プロジェクト構成（例）

/project-root  
├─ src  
├─ include  
├─ resources  
├─ translations  
├─ third_party  
├─ CMakeLists.txt  
├─ README.md  
├─ SPEC.md  
└─ LICENSE

---

## 16. README 必須記載内容

- ビルド手順（Windows / Linux）
- GUI起動方法
- CLI使用例
- 対応フォーマット
- プレビュー仕様
- 既知の制限
- ライセンス

---

## 17. ベンチマーク要件

- Releaseビルドで計測
- 同一画像1000枚程度での処理時間を提示
- I/O + 変換処理を含む総時間

---

## 18. ライセンス

- OSS前提（MIT / BSD / Apache-2.0 等）
- 使用ライブラリのライセンス明記必須

---

## 19. 実装上の原則

- 仕様外の機能追加は禁止
- UIや機能を拡張して汎用化しないこと
- 本ツールの価値は **速度・単純性・再現性** にある

